<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Main function for fitting fixed effects model"><title>Main function for fitting fixed effects model — logis_fe • srrFE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Main function for fitting fixed effects model — logis_fe"><meta property="og:description" content="Main function for fitting fixed effects model"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">srrFE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/srrFE.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-appendix">Appendix</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-appendix">
    <a class="dropdown-item" href="../articles/Quick-start.html">Quick Start</a>
    <a class="dropdown-item" href="../articles/Models.html">Models</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/Articles.html">Articles</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/UM-KevinHe/srrFE/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Main function for fitting fixed effects model</h1>
      <small class="dont-index">Source: <a href="https://github.com/UM-KevinHe/srrFE/blob/HEAD/R/logis_fe.R" class="external-link"><code>R/logis_fe.R</code></a></small>
      <div class="d-none name"><code>logis_fe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Main function for fitting fixed effects model</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">logis_fe</span><span class="op">(</span></span>
<span>  <span class="va">data.prep</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"SerBIN"</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  bound <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  backtrack <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Rcpp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  AUC <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data.prep</dt>
<dd><p>an object from the <code><a href="fe_data_prep.html">fe_data_prep()</a></code> function.</p></dd>


<dt>algorithm</dt>
<dd><p>a string specifying the algorithm to be used. Defaulting to "SerBIN".</p><ul><li><p>"SerBIN": using the Serial blockwise inversion Newton algorithm to fit the model (See <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/sim.9387" class="external-link">Wu et al. (2022)</a>).</p></li>
<li><p>"BAN": using the block ascent Newton algorithm to fit the model (See <a href="https://link.springer.com/article/10.1007/s10985-013-9264-6" class="external-link">He et al. (2013)</a>).</p></li>
</ul></dd>


<dt>max.iter</dt>
<dd><p>maximum number of iterations. Defaulting to 10,000.</p></dd>


<dt>tol</dt>
<dd><p>a small positive number specifying stopping criterion of Newton-Raphson algorithm. Defaulting to 1e-5.</p></dd>


<dt>bound</dt>
<dd><p>a positive number to avoid inflation of provider effect. Defaulting to 10.</p></dd>


<dt>backtrack</dt>
<dd><p>a boolean indicating whether backtracking line search is implemented. Defaulting to FALSE.</p></dd>


<dt>Rcpp</dt>
<dd><p>a Boolean indicating whether the Rcpp function is used if "Rcpp = T". Defaulting to TRUE.</p></dd>


<dt>threads</dt>
<dd><p>a positive integer specifying the number of threads to be used. Defaulting to 1.</p></dd>


<dt>AUC</dt>
<dd><p>a Boolean indicating whether report AUC. Defaulting to FALSE.</p></dd>


<dt>message</dt>
<dd><p>a Boolean indicating whether track the fitting process. Defaulting to TRUE.</p></dd>


<dt>...</dt>
<dd></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object with S3 class <code>logis_fe</code>.</p>
<dl><dt>beta</dt>
<dd><p>a vector of fixed effects estimates of covariates</p></dd>


<dt>gamma</dt>
<dd><p>a vector of estimates of provider effects</p></dd>


<dt>linear_pred</dt>
<dd><p>a vector of linear predictors</p></dd>


<dt>pred</dt>
<dd><p>a vector of predicted probabilities</p></dd>


<dt>neg2Loglkd</dt>
<dd><p>minus two times log likelihood</p></dd>


<dt>AIC</dt>
<dd><p>Akaike info criterion</p></dd>


<dt>BIC</dt>
<dd><p>Bayesian info criterion</p></dd>


<dt>AUC</dt>
<dd><p>area under the ROC curve</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The default algorithm is based on Serial blockwise inversion Newton (SerBIN) proposed by
<a href="https://onlinelibrary.wiley.com/doi/full/10.1002/sim.9387" class="external-link">Wu et al. (2022)</a>,
but users can also choose to use the block ascent Newton (BAN) algorithm proposed by
<a href="https://link.springer.com/article/10.1007/s10985-013-9264-6" class="external-link">He et al. (2013)</a> to fit the model.
Both methodologies build upon the Newton-Raphson method, yet SerBIN simultaneously updates both the provider effect and covariate coefficient.
This concurrent update necessitates the inversion of the complete information matrix at each iteration.
In contrast, BAN adopts a two-layer updating approach, where the covariate coefficient is sequentially fixed to update the provider effect,
followed by fixing the provider effect to update the covariate coefficient.</p>
<p>We suggest using the default <code>"SerBIN"</code> option as it typically converges much faster for most datasets.
However, in rare cases where the SerBIN algorithm encounters second-order derivative irreversibility leading to an error,
users can consider using the <code>"BAN"</code> option as an alternative.</p>
<p>For a deeper understanding, please consult the original article for detailed insights.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Wu, W, Yang, Y, Kang, J, He, K. (2022) Improving large-scale estimation and inference for profiling health care providers.
<em>Statistics in Medicine</em>, <strong>41(15)</strong>: 2840-2853.</p></li>
<li><p>He K, Kalbfleisch, J, Li, Y, and et al. (2013) Evaluating hospital readmission rates in dialysis providers; adjusting for hospital effects.
<em>Lifetime Data Analysis</em>, <strong>19</strong>: 490-512.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data_FE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data.prep</span> <span class="op">&lt;-</span> <span class="fu"><a href="fe_data_prep.html">fe_data_prep</a></span><span class="op">(</span><span class="va">data_FE</span><span class="op">$</span><span class="va">Y</span>, <span class="va">data_FE</span><span class="op">$</span><span class="va">Z</span>, <span class="va">data_FE</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking missingness of variables ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing values NOT found. Checking missingness of variables completed!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking variation in covariates ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking variation in covariates completed!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking pairwise correlation among covariates ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking pairwise correlation among covariates completed!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking VIF of covariates ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking VIF of covariates completed!</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>0 out of 10 providers considered small and filtered out!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 out of 10 remaining providers with no events.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 out of 10 remaining providers with all events.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> After screening, 52% of all records exhibit occurrences of events (Y = 1)</span>
<span class="r-in"><span><span class="va">fit_fe</span> <span class="op">&lt;-</span> <span class="fu">logis_fe</span><span class="op">(</span><span class="va">data.prep</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://mcommunity.umich.edu/person/ybshao" class="external-link">Yubo Shao</a>, <a href="https://www.wenbowu.me/" class="external-link">Wenbo Wu</a>, <a href="https://www.um-kevinhe-group.org/" class="external-link">Kevin He</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

