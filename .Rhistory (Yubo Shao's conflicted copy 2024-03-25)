# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, rcpp = T)
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
b <- matrix(runif(9), 3,3)
b
b <- matrix(round(runif(16), 1), 4,4)
b
a <- c(1,2,3,4)
a + b
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
m <- 10
p <- 4
data2 <- sim_bin(m = m, n_obs = 50, n_beta = p)
data.prep2 <- fe_data_prep(data2$Y, data2$Z, data2$ID)
data_logistf2 <- data.prep2$data[, 1:6]
#(1)logistf
t1 <- Sys.time()
fit_logistf2 <- logistf(Y ~ factor(ID) + Z1 + Z2 + Z3 + Z4 - 1, data = data_logistf2)
coef(fit_logistf2)[c((m+1):(m + p))]
#         Z1        Z2        Z3        Z4
#  1.1868929 1.1609978 0.9508166 0.8962050
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 2.781918 mins
#(2)my code (no cpp yet)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
dim(data_logistf2)
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
m
fit_srrFE <- logis_firth(data.prep2)
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
#####-----large m -----#####
m <- 10
p <- 4
data2 <- sim_bin(m = m, n_obs = 50, n_beta = p)
data.prep2 <- fe_data_prep(data2$Y, data2$Z, data2$ID)
data_logistf2 <- data.prep2$data[, 1:6]
#(1)logistf
t1 <- Sys.time()
fit_logistf2 <- logistf(Y ~ factor(ID) + Z1 + Z2 + Z3 + Z4 - 1, data = data_logistf2)
coef(fit_logistf2)[c((m+1):(m + p))]
#         Z1        Z2        Z3        Z4
#  1.1868929 1.1609978 0.9508166 0.8962050
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 2.781918 mins
#(2)my code (no cpp yet)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
#####-----large m -----#####
m <- 10
p <- 4
data2 <- sim_bin(m = m, n_obs = 50, n_beta = p)
data.prep2 <- fe_data_prep(data2$Y, data2$Z, data2$ID)
data_logistf2 <- data.prep2$data[, 1:6]
#(1)logistf
t1 <- Sys.time()
fit_logistf2 <- logistf(Y ~ factor(ID) + Z1 + Z2 + Z3 + Z4 - 1, data = data_logistf2)
coef(fit_logistf2)[c((m+1):(m + p))]
#         Z1        Z2        Z3        Z4
#  1.1868929 1.1609978 0.9508166 0.8962050
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 2.781918 mins
#(2)my code (no cpp yet)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
-2.46816e+02
#(2)my code (no cpp yet)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, backtrack = T))
#(2)my code (no cpp yet)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, backtrack = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
#(2)my code (no cpp yet)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, backtrack = F)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
fit_srrFE <- logis_firth(data.prep2)
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
fit_srrFE <- logis_firth(data.prep2)
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE <- logis_firth(data.prep2, tol = 1e-15)
fit_srrFE$beta
fit_srrFE <- logis_firth(data.prep2, Rcpp = T, tol = 1e-15)
fit_srrFE$beta
fit_srrFE <- logis_firth(data.prep2, tol = 1e-15, backtrack = T))
fit_srrFE <- logis_firth(data.prep2, tol = 1e-15, backtrack = T)
fit_srrFE <- logis_firth(data.prep2, Rcpp = T, tol = 1e-15)
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/firth_compare.R")
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
m <- 10
p <- 4
data2 <- sim_bin(m = m, n_obs = 50, n_beta = p)
data.prep2 <- fe_data_prep(data2$Y, data2$Z, data2$ID)
data_logistf2 <- data.prep2$data[, 1:6]
#(1)logistf
t1 <- Sys.time()
fit_logistf2 <- logistf(Y ~ factor(ID) + Z1 + Z2 + Z3 + Z4 - 1, data = data_logistf2)
coef(fit_logistf2)[c((m+1):(m + p))]
#         Z1        Z2        Z3        Z4
#  1.1868929 1.1609978 0.9508166 0.8962050
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 2.781918 mins
#(2)my code (no cpp yet)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
m <- 2
p <- 4
data2 <- sim_bin(m = m, n_obs = 50, n_beta = p)
data.prep2 <- fe_data_prep(data2$Y, data2$Z, data2$ID)
data_logistf2 <- data.prep2$data[, 1:6]
#(1)logistf
t1 <- Sys.time()
fit_logistf2 <- logistf(Y ~ factor(ID) + Z1 + Z2 + Z3 + Z4 - 1, data = data_logistf2)
coef(fit_logistf2)[c((m+1):(m + p))]
#         Z1        Z2        Z3        Z4
#  1.1868929 1.1609978 0.9508166 0.8962050
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 2.781918 mins
#(2)my code (no cpp yet)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
fit_srrFE <- logis_firth(data.prep2)
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE$beta
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
fit_srrFE$beta
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/logis_firth.R")
Rcpp::sourceCpp("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/Fixed_effect.cpp")
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/sim_bin.R")
source("~/Dropbox (University of Michigan)/Group/Yubo/conditional logistic regression/Firth/fe_data_prep.R")
library(logistf)
#####-----large m -----#####
m <- 100
p <- 4
data2 <- sim_bin(m = m, n_obs = 50, n_beta = p)
data.prep2 <- fe_data_prep(data2$Y, data2$Z, data2$ID)
data_logistf2 <- data.prep2$data[, 1:6]
#(1)logistf
t1 <- Sys.time()
fit_logistf2 <- logistf(Y ~ factor(ID) + Z1 + Z2 + Z3 + Z4 - 1, data = data_logistf2)
coef(fit_logistf2)[c((m+1):(m + p))]
#         Z1        Z2        Z3        Z4
#  1.1868929 1.1609978 0.9508166 0.8962050
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 2.781918 mins
#(2)my code (without cpp)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
fit_srrFE <- logis_firth(data.prep2, backtrack = F)
fit_srrFE$beta
#(3) my code (with cpp)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 1.1868930
# Z2 1.1609979
# Z3 0.9508166
# Z4 0.8962051
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.462502 secs
m <- 2
data2 <- sim_bin(m = m, n_obs = 50, n_beta = p)
data.prep2 <- fe_data_prep(data2$Y, data2$Z, data2$ID)
data_logistf2 <- data.prep2$data[, 1:6]
#(1)logistf
t1 <- Sys.time()
fit_logistf2 <- logistf(Y ~ factor(ID) + Z1 + Z2 + Z3 + Z4 - 1, data = data_logistf2)
coef(fit_logistf2)[c((m+1):(m + p))]
#         Z1        Z2        Z3        Z4
#  0.7398405 0.8010679 1.2257457 1.3165310
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.009552002 secs
#(2) my code (without cpp)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2)   #default is using "backtracking", if we don't use backtracking, the results will be exactly the same!
fit_srrFE$beta
#         beta
# Z1 0.9507286
# Z2 1.1218074
# Z3 1.0769767
# Z4 1.1693615
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 1.644826 secs
#(2) my code (without cpp)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, backtrack = F)   #default is using "backtracking", if we don't use backtracking, the results will be exactly the same!
fit_srrFE$beta
#         beta
# Z1 1.135008
# Z2 1.735626
# Z3 0.415418
# Z4 2.754886
#(3) my code (with cpp)
t1 <- Sys.time()
fit_srrFE <- logis_firth(data.prep2, Rcpp = T)
fit_srrFE$beta
#         beta
# Z1 0.9507286
# Z2 1.1218074
# Z3 1.0769767
# Z4 1.1693615
t2 <- Sys.time()
print(t2 - t1)  #Time difference of 0.134197 secs
devtools::document()
pkgdown::build_site()
?Rcpp.package.skeleton
setwd("C:\Users\ybshao\Desktop\New folder")
getwd()
setwd("C:/Users/ybshao/Desktop/New folder")
library(Rcpp)
library(Rcpp)
Rcpp.package.skeleton("temp", path = "C:/Users/ybshao/Desktop/New folder/temp_package",
code_files = c("logis_fe.R"),
cpp_files = c("Fixed_effect.cpp"))
Rcpp.package.skeleton("temp", path = "C:/Users/ybshao/Desktop/New folder/temp_package",
code_files = c("logis_fe.R"),
cpp_files = c("Fixed_effect.cpp"))
RcppArmadillo.package.skeleton("temp2", path = "C:/Users/ybshao/Desktop/New folder/temp_package",
code_files = c("logis_fe.R"),
cpp_files = c("Fixed_effect.cpp"))
library(RcppArmadillo)
RcppArmadillo.package.skeleton("temp2", path = "C:/Users/ybshao/Desktop/New folder/temp_package",
code_files = c("logis_fe.R"),
cpp_files = c("Fixed_effect.cpp"))
?RcppArmadillo.package.skeleton
RcppArmadillo.package.skeleton("temp2", path = "C:/Users/ybshao/Desktop/New folder/temp_package",
code_files = c("logis_fe.R"))
Rcpp::compileAttributes()
devtools::document()
remotes::install_github("UM-KevinHe/srrFE", ref = "main")
remove.packages("srrFE")
remotes::install_github("UM-KevinHe/srrFE", ref = "main")
library(srrFE)
data(data_FE)
data.prep <- fe_data_prep(data_FE$Y, data_FE$Z, data_FE$ID)
head(data.prep$data)
fit_fe <- logis_fe(data.prep)
library(Rcpp)
library(RcppArmadillo)
setwd("C:/Users/ybshao/Desktop/New folder")
Rcpp.package.skeleton("temp", path = "temp_package",
code_files = c("logis_fe.R"),
cpp_files = c("Fixed_effect.cpp"))
devtools::document()
Rcpp::compileAttributes()
devtools::document()
pkgdown::build_site()
pkgdown::build_site()
devtools::document()
pkgdown::build_site()
pkgdown::build_site()
devtools::document()
pkgdown::build_site()
pkgdown::build_site()
devtools::document()
pkgdown::build_site()
pkgdown::build_site()
devtools::document()
pkgdown::build_site()
devtools::document()
pkgdown::build_site()
devtools::document()
devtools::document()
pkgdown::build_site()
devtools::document()
devtools::document()
pkgdown::build_site()
devtools::document()
devtools::document()
pkgdown::build_site()
remotes::install_github("UM-KevinHe/srrFE", ref = "main")
devtools::document()
pkgdown::build_site()
pkgdown::build_site()
devtools::document()
pkgdown::build_site()
Rcpp::compileAttributes()
22 + 72 * 4 + 43 + 72 * 4 + 39
Rcpp::compileAttributes()
roxygen2::roxygenize()
devtools::build()
Rcpp::compileAttributes()
devtools::document()
library(srrFE)
detach("package:srrFE", unload = TRUE)
remove.packages("srrFE")
library(srrFE)
detach("package:srrFE", unload = TRUE)
library(srrFE)
data(data_FE)
data.prep <- fe_data_prep(data_FE$Y, data_FE$Z, data_FE$ID)
head(data.prep$data)
fit_fe <- logis_fe(data.prep)
coef(fit_fe)
